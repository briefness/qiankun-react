{"ast":null,"code":"\"use strict\";\n/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"foo_\", \"_bar\"], \"allowAfterThis\": true }] */\n\n/* eslint import/no-mutable-exports: 'off' */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar utils_1 = require(\"./utils\");\n\nvar cache_1 = require(\"./cache\");\n\nvar storeNameSpace = 'store';\n\nvar Store =\n/** @class */\nfunction () {\n  function Store() {\n    this.store = {};\n    this.storeEmitter = {};\n  }\n\n  Store.prototype._getValue = function (key) {\n    return this.store[key];\n  };\n\n  Store.prototype._setValue = function (key, value) {\n    this.store[key] = value;\n\n    this._emit(key);\n  };\n\n  Store.prototype._emit = function (key) {\n    var keyEmitter = this.storeEmitter[key];\n\n    if (!utils_1.isArray(keyEmitter) || utils_1.isArray(keyEmitter) && keyEmitter.length === 0) {\n      return;\n    }\n\n    var value = this._getValue(key);\n\n    keyEmitter.forEach(function (cb) {\n      cb(value);\n    });\n  };\n\n  Store.prototype.get = function (key) {\n    if (key === undefined) {\n      return this.store;\n    }\n\n    if (typeof key !== 'string') {\n      utils_1.warn(\"store.get: key should be string\");\n      return null;\n    }\n\n    return this._getValue(key);\n  };\n\n  Store.prototype.set = function (key, value) {\n    var _this = this;\n\n    if (typeof key !== 'string') {\n      if (!utils_1.isObject(key)) {\n        utils_1.warn('store.set: key should be string / object');\n        return;\n      }\n\n      Object.keys(key).forEach(function (k) {\n        var v = key[k];\n\n        _this._setValue(k, v);\n      });\n    }\n\n    this._setValue(key, value);\n  };\n\n  Store.prototype.on = function (key, callback, force) {\n    if (typeof key !== 'string') {\n      utils_1.warn('store.on: key should be string');\n      return;\n    }\n\n    if (callback === undefined || typeof callback !== 'function') {\n      utils_1.warn('store.on: callback is required, should be function');\n      return;\n    }\n\n    if (!this.storeEmitter[key]) {\n      this.storeEmitter[key] = [];\n    }\n\n    this.storeEmitter[key].push(callback);\n\n    if (force) {\n      callback(this._getValue(key));\n    }\n  };\n\n  Store.prototype.off = function (key, callback) {\n    if (typeof key !== 'string') {\n      utils_1.warn('store.off: key should be string');\n      return;\n    }\n\n    if (!utils_1.isArray(this.storeEmitter[key])) {\n      utils_1.warn(\"store.off: \" + key + \" has no callback\");\n      return;\n    }\n\n    if (callback === undefined) {\n      this.storeEmitter[key] = undefined;\n      return;\n    }\n\n    this.storeEmitter[key] = this.storeEmitter[key].filter(function (cb) {\n      return cb !== callback;\n    });\n  };\n\n  Store.prototype.has = function (key) {\n    var keyEmitter = this.storeEmitter[key];\n    return utils_1.isArray(keyEmitter) && keyEmitter.length > 0;\n  };\n\n  return Store;\n}();\n\nvar store = cache_1.getCache(storeNameSpace);\n\nif (!store) {\n  store = new Store();\n  cache_1.setCache(storeNameSpace, store);\n}\n\nexports.default = store;","map":{"version":3,"sources":["../src/store.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"foo_\", \"_bar\"], \"allowAfterThis\": true }] */\n/* eslint import/no-mutable-exports: 'off' */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nvar cache_1 = require(\"./cache\");\nvar storeNameSpace = 'store';\nvar Store = /** @class */ (function () {\n    function Store() {\n        this.store = {};\n        this.storeEmitter = {};\n    }\n    Store.prototype._getValue = function (key) {\n        return this.store[key];\n    };\n    Store.prototype._setValue = function (key, value) {\n        this.store[key] = value;\n        this._emit(key);\n    };\n    Store.prototype._emit = function (key) {\n        var keyEmitter = this.storeEmitter[key];\n        if (!utils_1.isArray(keyEmitter) || (utils_1.isArray(keyEmitter) && keyEmitter.length === 0)) {\n            return;\n        }\n        var value = this._getValue(key);\n        keyEmitter.forEach(function (cb) {\n            cb(value);\n        });\n    };\n    Store.prototype.get = function (key) {\n        if (key === undefined) {\n            return this.store;\n        }\n        if (typeof key !== 'string') {\n            utils_1.warn(\"store.get: key should be string\");\n            return null;\n        }\n        return this._getValue(key);\n    };\n    Store.prototype.set = function (key, value) {\n        var _this = this;\n        if (typeof key !== 'string') {\n            if (!utils_1.isObject(key)) {\n                utils_1.warn('store.set: key should be string / object');\n                return;\n            }\n            Object.keys(key).forEach(function (k) {\n                var v = key[k];\n                _this._setValue(k, v);\n            });\n        }\n        this._setValue(key, value);\n    };\n    Store.prototype.on = function (key, callback, force) {\n        if (typeof key !== 'string') {\n            utils_1.warn('store.on: key should be string');\n            return;\n        }\n        if (callback === undefined || typeof callback !== 'function') {\n            utils_1.warn('store.on: callback is required, should be function');\n            return;\n        }\n        if (!this.storeEmitter[key]) {\n            this.storeEmitter[key] = [];\n        }\n        this.storeEmitter[key].push(callback);\n        if (force) {\n            callback(this._getValue(key));\n        }\n    };\n    Store.prototype.off = function (key, callback) {\n        if (typeof key !== 'string') {\n            utils_1.warn('store.off: key should be string');\n            return;\n        }\n        if (!utils_1.isArray(this.storeEmitter[key])) {\n            utils_1.warn(\"store.off: \" + key + \" has no callback\");\n            return;\n        }\n        if (callback === undefined) {\n            this.storeEmitter[key] = undefined;\n            return;\n        }\n        this.storeEmitter[key] = this.storeEmitter[key].filter(function (cb) { return cb !== callback; });\n    };\n    Store.prototype.has = function (key) {\n        var keyEmitter = this.storeEmitter[key];\n        return utils_1.isArray(keyEmitter) && keyEmitter.length > 0;\n    };\n    return Store;\n}());\nvar store = cache_1.getCache(storeNameSpace);\nif (!store) {\n    store = new Store();\n    cache_1.setCache(storeNameSpace, store);\n}\nexports.default = store;\n//# sourceMappingURL=store.js.map"]},"metadata":{},"sourceType":"script"}