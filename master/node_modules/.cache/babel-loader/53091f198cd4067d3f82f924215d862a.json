{"ast":null,"code":"import{jsx as _jsx}from\"react/jsx-runtime\";/*\n * @Author: your name\n * @Date: 2021-01-12 10:42:07\n * @LastEditTime: 2021-01-27 14:08:18\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /webpack-test/Users/mory/Desktop/qiankun-react/src/index.js\n */import React from'react';import ReactDOM from'react-dom';import'./index.css';import App from'./App';// import * as serviceWorker from './serviceWorker';\nimport{registerMicroApps,start}from'qiankun';import{setDefaultMountApp}from'./utils';import{initGlobalState}from'./utils/globalState';function render(_ref){var appContent=_ref.appContent,loading=_ref.loading;var container=document.getElementById('root');ReactDOM.render(/*#__PURE__*/_jsx(App,{loading:loading,content:appContent}),container);}/**\n * Step1 初始化应用（可选）\n */render({loading:true});function genActiveRule(routerPrefix){return function(location){return location.pathname.startsWith(routerPrefix);};}/**\n * Step2 注册子应用\n * entry： 为微应用的访问地址\n */registerMicroApps([{name:'react1',entry:'//localhost:6651',render:render,activeRule:genActiveRule('/react1')},{name:'react2',entry:'//localhost:6652',render:render,activeRule:genActiveRule('/react2')}]);var _initGlobalState=initGlobalState({user:'qiankun'}),onGlobalStateChange=_initGlobalState.onGlobalStateChange,setGlobalState=_initGlobalState.setGlobalState;onGlobalStateChange(function(value,prev){return console.log('[onGlobalStateChange - master]:',value,prev);});setGlobalState({ignore:'master',user:{name:'master'}});/**\n * Step3 设置默认进入的子应用\n */setDefaultMountApp('/react1');/**\n * Step4 启动应用\n */start();// serviceWorker.unregister();","map":{"version":3,"sources":["/Users/mory/Desktop/qiankun-react/master/src/index.js"],"names":["React","ReactDOM","App","registerMicroApps","start","setDefaultMountApp","initGlobalState","render","appContent","loading","container","document","getElementById","genActiveRule","routerPrefix","location","pathname","startsWith","name","entry","activeRule","user","onGlobalStateChange","setGlobalState","value","prev","console","log","ignore"],"mappings":"2CAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GACA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA,MAAO,aAAP,CACA,MAAOC,CAAAA,GAAP,KAAgB,OAAhB,CACA;AACA,OAASC,iBAAT,CAA4BC,KAA5B,KAAyC,SAAzC,CAEA,OAASC,kBAAT,KAAmC,SAAnC,CAEA,OAASC,eAAT,KAAgC,qBAAhC,CAEA,QAASC,CAAAA,MAAT,MAAyC,IAAvBC,CAAAA,UAAuB,MAAvBA,UAAuB,CAAXC,OAAW,MAAXA,OAAW,CACvC,GAAMC,CAAAA,SAAS,CAAGC,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAAlB,CACAX,QAAQ,CAACM,MAAT,cAAgB,KAAC,GAAD,EAAK,OAAO,CAAEE,OAAd,CAAuB,OAAO,CAAED,UAAhC,EAAhB,CAAgEE,SAAhE,EACD,CAED;AACA;AACA,GACAH,MAAM,CAAC,CAAEE,OAAO,CAAE,IAAX,CAAD,CAAN,CAEA,QAASI,CAAAA,aAAT,CAAuBC,YAAvB,CAAqC,CACnC,MAAO,UAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,QAAT,CAAkBC,UAAlB,CAA6BH,YAA7B,CAAJ,EAAf,CACD,CAED;AACA;AACA;AACA,GACAX,iBAAiB,CAAC,CAChB,CACEe,IAAI,CAAE,QADR,CAEEC,KAAK,CAAE,kBAFT,CAGEZ,MAAM,CAANA,MAHF,CAIEa,UAAU,CAAEP,aAAa,CAAC,SAAD,CAJ3B,CADgB,CAOhB,CACEK,IAAI,CAAE,QADR,CAEEC,KAAK,CAAE,kBAFT,CAGEZ,MAAM,CAANA,MAHF,CAIEa,UAAU,CAAEP,aAAa,CAAC,SAAD,CAJ3B,CAPgB,CAAD,CAAjB,C,qBAegDP,eAAe,CAAC,CAC9De,IAAI,CAAE,SADwD,CAAD,C,CAAvDC,mB,kBAAAA,mB,CAAqBC,c,kBAAAA,c,CAI7BD,mBAAmB,CAAC,SAACE,KAAD,CAAQC,IAAR,QAAiBC,CAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ,CAA+CH,KAA/C,CAAsDC,IAAtD,CAAjB,EAAD,CAAnB,CAEAF,cAAc,CAAC,CACbK,MAAM,CAAE,QADK,CAEbP,IAAI,CAAE,CACJH,IAAI,CAAE,QADF,CAFO,CAAD,CAAd,CAOA;AACA;AACA,GACAb,kBAAkB,CAAC,SAAD,CAAlB,CAEA;AACA;AACA,GACAD,KAAK,GAGL","sourcesContent":["/*\n * @Author: your name\n * @Date: 2021-01-12 10:42:07\n * @LastEditTime: 2021-01-27 14:08:18\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /webpack-test/Users/mory/Desktop/qiankun-react/src/index.js\n */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\nimport { registerMicroApps, start } from 'qiankun';\n\nimport { setDefaultMountApp } from './utils';\n\nimport { initGlobalState } from './utils/globalState';\n\nfunction render({ appContent, loading }) {\n  const container = document.getElementById('root');\n  ReactDOM.render(<App loading={loading} content={appContent} />, container);\n}\n\n/**\n * Step1 初始化应用（可选）\n */\nrender({ loading: true });\n\nfunction genActiveRule(routerPrefix) {\n  return location => location.pathname.startsWith(routerPrefix);\n}\n\n/**\n * Step2 注册子应用\n * entry： 为微应用的访问地址\n */\nregisterMicroApps([\n  {\n    name: 'react1',\n    entry: '//localhost:6651',\n    render,\n    activeRule: genActiveRule('/react1')\n  },\n  {\n    name: 'react2',\n    entry: '//localhost:6652',\n    render,\n    activeRule: genActiveRule('/react2') \n  },\n]);\n\nconst { onGlobalStateChange, setGlobalState } = initGlobalState({\n  user: 'qiankun',\n});\n\nonGlobalStateChange((value, prev) => console.log('[onGlobalStateChange - master]:', value, prev));\n\nsetGlobalState({\n  ignore: 'master',\n  user: {\n    name: 'master',\n  },\n});\n\n/**\n * Step3 设置默认进入的子应用\n */\nsetDefaultMountApp('/react1');\n\n/**\n * Step4 启动应用\n */\nstart();\n\n\n// serviceWorker.unregister();"]},"metadata":{},"sourceType":"module"}