{"ast":null,"code":"import _noop from \"lodash/noop\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar rawAddEventListener = window.addEventListener;\nvar rawRemoveEventListener = window.removeEventListener;\nexport default function patch(global) {\n  var listenerMap = new Map();\n\n  global.addEventListener = function (type, listener, options) {\n    var listeners = listenerMap.get(type) || [];\n    listenerMap.set(type, [].concat(_toConsumableArray(listeners), [listener]));\n    return rawAddEventListener.call(window, type, listener, options);\n  };\n\n  global.removeEventListener = function (type, listener, options) {\n    var storedTypeListeners = listenerMap.get(type);\n\n    if (storedTypeListeners && storedTypeListeners.length && storedTypeListeners.indexOf(listener) !== -1) {\n      storedTypeListeners.splice(storedTypeListeners.indexOf(listener), 1);\n    }\n\n    return rawRemoveEventListener.call(window, type, listener, options);\n  };\n\n  return function free() {\n    listenerMap.forEach(function (listeners, type) {\n      return _toConsumableArray(listeners).forEach(function (listener) {\n        return global.removeEventListener(type, listener);\n      });\n    });\n    global.addEventListener = rawAddEventListener;\n    global.removeEventListener = rawRemoveEventListener;\n    return _noop;\n  };\n}","map":{"version":3,"sources":["/Users/mory/Desktop/qiankun-react/master/node_modules/qiankun/es/sandbox/patchers/windowListener.js"],"names":["_noop","_toConsumableArray","rawAddEventListener","window","addEventListener","rawRemoveEventListener","removeEventListener","patch","global","listenerMap","Map","type","listener","options","listeners","get","set","concat","call","storedTypeListeners","length","indexOf","splice","free","forEach"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,aAAlB;AACA,OAAOC,kBAAP,MAA+B,8CAA/B;AACA,IAAIC,mBAAmB,GAAGC,MAAM,CAACC,gBAAjC;AACA,IAAIC,sBAAsB,GAAGF,MAAM,CAACG,mBAApC;AACA,eAAe,SAASC,KAAT,CAAeC,MAAf,EAAuB;AACpC,MAAIC,WAAW,GAAG,IAAIC,GAAJ,EAAlB;;AAEAF,EAAAA,MAAM,CAACJ,gBAAP,GAA0B,UAAUO,IAAV,EAAgBC,QAAhB,EAA0BC,OAA1B,EAAmC;AAC3D,QAAIC,SAAS,GAAGL,WAAW,CAACM,GAAZ,CAAgBJ,IAAhB,KAAyB,EAAzC;AACAF,IAAAA,WAAW,CAACO,GAAZ,CAAgBL,IAAhB,EAAsB,GAAGM,MAAH,CAAUhB,kBAAkB,CAACa,SAAD,CAA5B,EAAyC,CAACF,QAAD,CAAzC,CAAtB;AACA,WAAOV,mBAAmB,CAACgB,IAApB,CAAyBf,MAAzB,EAAiCQ,IAAjC,EAAuCC,QAAvC,EAAiDC,OAAjD,CAAP;AACD,GAJD;;AAMAL,EAAAA,MAAM,CAACF,mBAAP,GAA6B,UAAUK,IAAV,EAAgBC,QAAhB,EAA0BC,OAA1B,EAAmC;AAC9D,QAAIM,mBAAmB,GAAGV,WAAW,CAACM,GAAZ,CAAgBJ,IAAhB,CAA1B;;AAEA,QAAIQ,mBAAmB,IAAIA,mBAAmB,CAACC,MAA3C,IAAqDD,mBAAmB,CAACE,OAApB,CAA4BT,QAA5B,MAA0C,CAAC,CAApG,EAAuG;AACrGO,MAAAA,mBAAmB,CAACG,MAApB,CAA2BH,mBAAmB,CAACE,OAApB,CAA4BT,QAA5B,CAA3B,EAAkE,CAAlE;AACD;;AAED,WAAOP,sBAAsB,CAACa,IAAvB,CAA4Bf,MAA5B,EAAoCQ,IAApC,EAA0CC,QAA1C,EAAoDC,OAApD,CAAP;AACD,GARD;;AAUA,SAAO,SAASU,IAAT,GAAgB;AACrBd,IAAAA,WAAW,CAACe,OAAZ,CAAoB,UAAUV,SAAV,EAAqBH,IAArB,EAA2B;AAC7C,aAAOV,kBAAkB,CAACa,SAAD,CAAlB,CAA8BU,OAA9B,CAAsC,UAAUZ,QAAV,EAAoB;AAC/D,eAAOJ,MAAM,CAACF,mBAAP,CAA2BK,IAA3B,EAAiCC,QAAjC,CAAP;AACD,OAFM,CAAP;AAGD,KAJD;AAKAJ,IAAAA,MAAM,CAACJ,gBAAP,GAA0BF,mBAA1B;AACAM,IAAAA,MAAM,CAACF,mBAAP,GAA6BD,sBAA7B;AACA,WAAOL,KAAP;AACD,GATD;AAUD","sourcesContent":["import _noop from \"lodash/noop\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar rawAddEventListener = window.addEventListener;\nvar rawRemoveEventListener = window.removeEventListener;\nexport default function patch(global) {\n  var listenerMap = new Map();\n\n  global.addEventListener = function (type, listener, options) {\n    var listeners = listenerMap.get(type) || [];\n    listenerMap.set(type, [].concat(_toConsumableArray(listeners), [listener]));\n    return rawAddEventListener.call(window, type, listener, options);\n  };\n\n  global.removeEventListener = function (type, listener, options) {\n    var storedTypeListeners = listenerMap.get(type);\n\n    if (storedTypeListeners && storedTypeListeners.length && storedTypeListeners.indexOf(listener) !== -1) {\n      storedTypeListeners.splice(storedTypeListeners.indexOf(listener), 1);\n    }\n\n    return rawRemoveEventListener.call(window, type, listener, options);\n  };\n\n  return function free() {\n    listenerMap.forEach(function (listeners, type) {\n      return _toConsumableArray(listeners).forEach(function (listener) {\n        return global.removeEventListener(type, listener);\n      });\n    });\n    global.addEventListener = rawAddEventListener;\n    global.removeEventListener = rawRemoveEventListener;\n    return _noop;\n  };\n}"]},"metadata":{},"sourceType":"module"}